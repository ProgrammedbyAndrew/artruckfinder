<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Navigational Arrow to Coordinates</title>
    <style>
        body {
            margin: 0;
            font-family: sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background: #f0f0f0;
            align-items: center;
            justify-content: center;
        }

        .arrow-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .arrow {
            font-size: 100px; 
            transition: transform 0.3s ease;
            margin-bottom: 20px;
        }

        .distance {
            font-size: 24px;
            background: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>

    <div class="arrow-display">
        <div class="arrow" id="arrow">↑</div>
        <div class="distance" id="distance">Calculating distance...</div>
    </div>

    <script>
        // Target coordinates in decimal degrees
        const targetLat = 28.33722;
        const targetLon = -81.46333;

        // Convert degrees to radians
        function toRad(deg) {
            return deg * Math.PI / 180;
        }

        // Haversine formula to calculate distance between two lat/lon points
        function haversineDistance(lat1, lon1, lat2, lon2) {
            const R = 6371e3; // Earth radius in meters
            const φ1 = toRad(lat1);
            const φ2 = toRad(lat2);
            const Δφ = toRad(lat2 - lat1);
            const Δλ = toRad(lon2 - lon1);

            const a = Math.sin(Δφ / 2) * Math.sin(Δφ / 2) +
                      Math.cos(φ1) * Math.cos(φ2) *
                      Math.sin(Δλ / 2) * Math.sin(Δλ / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

            const distance = R * c; // in meters
            return distance;
        }

        // Formula to calculate bearing from one point to another
        function bearingToTarget(lat1, lon1, lat2, lon2) {
            const φ1 = toRad(lat1);
            const φ2 = toRad(lat2);
            const λ1 = toRad(lon1);
            const λ2 = toRad(lon2);

            const y = Math.sin(λ2 - λ1) * Math.cos(φ2);
            const x = Math.cos(φ1)*Math.sin(φ2) -
                      Math.sin(φ1)*Math.cos(φ2)*Math.cos(λ2 - λ1);
            const θ = Math.atan2(y, x);
            let bearing = (θ * 180 / Math.PI + 360) % 360; // in degrees
            return bearing;
        }

        const arrow = document.getElementById('arrow');
        const distanceDiv = document.getElementById('distance');

        // Watch user's position
        if ('geolocation' in navigator) {
            navigator.geolocation.watchPosition(position => {
                const lat = position.coords.latitude;
                const lon = position.coords.longitude;

                // Compute bearing
                const bearing = bearingToTarget(lat, lon, targetLat, targetLon);
                // Rotate arrow so that "up" (the original arrow) points towards target
                // Arrow default "up" means arrow is facing north (0deg).
                // Bearing degrees from North. So rotate arrow by that bearing.
                arrow.style.transform = `rotate(${bearing}deg)`;

                // Compute distance in meters and convert to feet
                const distanceMeters = haversineDistance(lat, lon, targetLat, targetLon);
                const distanceFeet = distanceMeters * 3.28084;
                distanceDiv.textContent = `${distanceFeet.toFixed(0)} ft away`;
            }, 
            error => {
                distanceDiv.textContent = "Unable to get location.";
            },
            {
                enableHighAccuracy: true
            });
        } else {
            distanceDiv.textContent = "Geolocation not supported.";
        }
    </script>

</body>
</html>